<%= form_with(model: note, class: 'mx-auto mt-6') do |form| %>
  <%= render 'components/errors', resource: note %>

  <% if note.notable_type.present? && note.notable_id.present? %>
    <%= form.hidden_field :notable_type %>
    <%= form.hidden_field :notable_id %>
  <% end %>

  <% placeholder = {
    'JobLead' => 'Add additional details about this job lead, why youâ€™re interested, or any next steps.',
    'Interview' => 'Add notes about the interview, questions asked, or your impressions.'
  } %>

  <div class="space-y-6">
    <div style="view-transition-name: note-<%= note.id %>;">
      <%= form.label :content, 'Note', class: 'sr-only' %>
      <div class="form-textarea-wrap" data-replicated-value="<%= form.object.content.to_s %>">
        <%= form.text_area :content, autofocus: true, class: 'form-textarea', rows: 6, placeholder: placeholder[note.notable_type], oninput: 'this.parentNode.dataset.replicatedValue = this.value' %>
      </div>
      <p class="text-xs text-muted mt-1">Markdown is supported for formatting your note.</p>
    </div>

    <div class="sticky bottom-0 bg-white dark:bg-neutral-950 py-4 -mx-(--main-padding) px-(--main-padding) md:-mx-1 md:px-1 max-md:pb-[calc(var(--tab-bar-height)*1.6)] border-t border-neutral-200 dark:border-neutral-800">
      <%= form.submit note.persisted? ? 'Save Changes' : 'Save Note', class: 'btn btn-primary w-full sm:w-auto' %>
    </div>
  </div>
<% end %>
